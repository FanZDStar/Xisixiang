# ğŸš€ å¿«é€Ÿå¼€å§‹ï¼šå°†é¡¹ç›®è½¬æ¢ä¸ºå°ç¨‹åº

## æ–¹æ¡ˆé€‰æ‹©å»ºè®®

åŸºäºä½ çš„é¡¹ç›®ï¼Œæˆ‘å¼ºçƒˆæ¨èä½¿ç”¨ **uni-app**ï¼š

âœ… **ä¼˜åŠ¿**ï¼š

- ä½¿ç”¨ Vue 3 è¯­æ³•ï¼Œç°æœ‰ä»£ç å¯å¤ç”¨ 70-80%
- æ”¯æŒåŒæ—¶å‘å¸ƒåˆ°å¾®ä¿¡ã€æ”¯ä»˜å®ã€ç™¾åº¦ã€å­—èŠ‚è·³åŠ¨ç­‰å°ç¨‹åº
- æˆç†Ÿçš„ç”Ÿæ€å’Œå®Œå–„çš„æ–‡æ¡£

---

## ç¬¬ä¸€æ­¥ï¼šåˆ›å»º uni-app é¡¹ç›®

### æ–¹å¼ 1ï¼šä½¿ç”¨ HBuilderXï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. **ä¸‹è½½å®‰è£… HBuilderX**

   - å®˜ç½‘ï¼šhttps://www.dcloud.io/hbuilderx.html
   - ä¸‹è½½æ ‡å‡†ç‰ˆå³å¯

2. **åˆ›å»ºé¡¹ç›®**

   ```
   æ–‡ä»¶ â†’ æ–°å»º â†’ é¡¹ç›®
   â†’ é€‰æ‹© uni-app
   â†’ é€‰æ‹© Vue3 æ¨¡æ¿
   â†’ è¾“å…¥é¡¹ç›®åï¼šminiprogram-xisixiang
   ```

3. **è¿è¡Œåˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·**
   ```
   è¿è¡Œ â†’ è¿è¡Œåˆ°å°ç¨‹åºæ¨¡æ‹Ÿå™¨ â†’ å¾®ä¿¡å¼€å‘è€…å·¥å…·
   ```

### æ–¹å¼ 2ï¼šä½¿ç”¨å‘½ä»¤è¡Œï¼ˆæ¨èæœ‰ç»éªŒè€…ï¼‰

```powershell
# å…¨å±€å®‰è£… Vue CLI
npm install -g @vue/cli

# åˆ›å»º uni-app é¡¹ç›®ï¼ˆVue 3 ç‰ˆæœ¬ï¼‰
npx degit dcloudio/uni-preset-vue#vite miniprogram-xisixiang

# è¿›å…¥é¡¹ç›®ç›®å½•
cd miniprogram-xisixiang

# å®‰è£…ä¾èµ–
npm install

# è¿è¡Œåˆ°å¾®ä¿¡å°ç¨‹åº
npm run dev:mp-weixin
```

---

## ç¬¬äºŒæ­¥ï¼šé…ç½®é¡¹ç›®ç»“æ„

### 1. åˆ›å»ºé¡µé¢ç›®å½•ç»“æ„

```powershell
cd miniprogram-xisixiang

# åˆ›å»ºé¡µé¢ç›®å½•
mkdir -p pages/chat pages/quiz pages/theory pages/knowledge-graph

# åˆ›å»º components ç›®å½•
mkdir -p components/chat components/quiz
```

### 2. é…ç½® pages.jsonï¼ˆæ ¸å¿ƒè·¯ç”±é…ç½®ï¼‰

åˆ›å»º `pages.json`ï¼š

```json
{
  "pages": [
    {
      "path": "pages/chat/chat",
      "style": {
        "navigationBarTitleText": "æ™ºèƒ½é—®ç­”",
        "navigationBarBackgroundColor": "#ff4d4d",
        "navigationBarTextStyle": "white"
      }
    },
    {
      "path": "pages/quiz/quiz",
      "style": {
        "navigationBarTitleText": "ä¹ é¢˜è®­ç»ƒ",
        "navigationBarBackgroundColor": "#ff4d4d",
        "navigationBarTextStyle": "white"
      }
    },
    {
      "path": "pages/theory/theory",
      "style": {
        "navigationBarTitleText": "ç†è®ºå­¦ä¹ ",
        "navigationBarBackgroundColor": "#ff4d4d",
        "navigationBarTextStyle": "white"
      }
    }
  ],
  "tabBar": {
    "color": "#666666",
    "selectedColor": "#ff4d4d",
    "backgroundColor": "#ffffff",
    "list": [
      {
        "pagePath": "pages/chat/chat",
        "text": "æ™ºèƒ½é—®ç­”"
      },
      {
        "pagePath": "pages/quiz/quiz",
        "text": "ä¹ é¢˜è®­ç»ƒ"
      },
      {
        "pagePath": "pages/theory/theory",
        "text": "ç†è®ºå­¦ä¹ "
      }
    ]
  },
  "globalStyle": {
    "navigationBarTextStyle": "white",
    "navigationBarTitleText": "ä¹ æ€æƒ³è¯¾ç¨‹",
    "navigationBarBackgroundColor": "#ff4d4d",
    "backgroundColor": "#f5f5f5"
  }
}
```

---

## ç¬¬ä¸‰æ­¥ï¼šè¿ç§»å…³é”®åŠŸèƒ½

### 1. åˆ›å»º API è¯·æ±‚å·¥å…·

åˆ›å»º `utils/request.js`ï¼š

```javascript
// utils/request.js
const BASE_URL = "http://localhost:5000"; // å¼€å‘ç¯å¢ƒ
// const BASE_URL = 'https://your-domain.com'; // ç”Ÿäº§ç¯å¢ƒ

export function request(options) {
  return new Promise((resolve, reject) => {
    uni.showLoading({
      title: "åŠ è½½ä¸­...",
      mask: true,
    });

    uni.request({
      url: BASE_URL + options.url,
      method: options.method || "GET",
      data: options.data || {},
      header: {
        "Content-Type": "application/json",
        ...options.header,
      },
      success: (res) => {
        uni.hideLoading();
        if (res.statusCode === 200) {
          resolve(res.data);
        } else {
          reject(new Error(`è¯·æ±‚å¤±è´¥: ${res.statusCode}`));
        }
      },
      fail: (err) => {
        uni.hideLoading();
        uni.showToast({
          title: "ç½‘ç»œè¯·æ±‚å¤±è´¥",
          icon: "none",
        });
        reject(err);
      },
    });
  });
}

// æ™ºèƒ½é—®ç­” API
export function chatCompletion(messages) {
  return request({
    url: "/api/chat",
    method: "POST",
    data: { messages },
  });
}

// è·å–é¢˜ç›®åˆ—è¡¨
export function getQuestions() {
  return request({
    url: "/api/questions",
    method: "GET",
  });
}

// è·å–éšæœºé¢˜ç›®
export function getRandomQuiz() {
  return request({
    url: "/api/quiz",
    method: "GET",
  });
}
```

### 2. åˆ›å»ºæ™ºèƒ½é—®ç­”é¡µé¢

åˆ›å»º `pages/chat/chat.vue`ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š

```vue
<template>
  <view class="chat-page">
    <!-- èŠå¤©çª—å£ -->
    <scroll-view
      scroll-y
      class="chat-window"
      :scroll-into-view="scrollIntoView"
      scroll-with-animation
    >
      <view
        v-for="(msg, index) in messages"
        :key="index"
        :id="'msg-' + index"
        :class="['message', msg.sender]"
      >
        <text>{{ msg.text }}</text>
      </view>
    </scroll-view>

    <!-- è¾“å…¥æ¡† -->
    <view class="input-box">
      <input
        v-model="inputText"
        placeholder="è¯·è¾“å…¥é—®é¢˜..."
        confirm-type="send"
        @confirm="sendMessage"
      />
      <button
        @click="sendMessage"
        :disabled="loading || !inputText"
        size="mini"
        type="warn"
      >
        å‘é€
      </button>
    </view>
  </view>
</template>

<script setup>
import { ref } from "vue";
import { chatCompletion } from "@/utils/request";

const messages = ref([
  { sender: "bot", text: "æ‚¨å¥½ï¼æˆ‘æ˜¯æ™ºèƒ½åŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ" },
]);
const inputText = ref("");
const loading = ref(false);
const scrollIntoView = ref("");

const sendMessage = async () => {
  if (!inputText.value.trim() || loading.value) return;

  const text = inputText.value.trim();
  messages.value.push({ sender: "user", text });
  inputText.value = "";
  loading.value = true;

  scrollIntoView.value = "msg-" + (messages.value.length - 1);

  try {
    const res = await chatCompletion(buildPayload());
    messages.value.push({
      sender: "bot",
      text: res.reply || "æŠ±æ­‰ï¼Œæˆ‘æš‚æ—¶æ— æ³•å›ç­”ã€‚",
    });
  } catch (error) {
    messages.value.push({
      sender: "bot",
      text: "æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åå†è¯•ã€‚",
    });
  } finally {
    loading.value = false;
    scrollIntoView.value = "msg-" + (messages.value.length - 1);
  }
};

const buildPayload = () => {
  return messages.value.map((m) => ({
    role: m.sender === "bot" ? "assistant" : "user",
    content: m.text,
  }));
};
</script>

<style scoped>
.chat-page {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

.chat-window {
  flex: 1;
  padding: 20rpx;
  background-color: #f5f5f5;
}

.message {
  max-width: 70%;
  padding: 20rpx;
  margin-bottom: 20rpx;
  border-radius: 10rpx;
  word-wrap: break-word;
}

.message.user {
  background: linear-gradient(135deg, #ff7061, #f44336);
  color: white;
  margin-left: auto;
  align-self: flex-end;
}

.message.bot {
  background-color: white;
  color: #333;
}

.input-box {
  display: flex;
  padding: 20rpx;
  background-color: white;
  border-top: 1px solid #eee;
  gap: 20rpx;
}

.input-box input {
  flex: 1;
  padding: 20rpx;
  border: 1px solid #ddd;
  border-radius: 10rpx;
}

.input-box button {
  padding: 20rpx 40rpx;
}
</style>
```

### 3. åˆ›å»ºä¹ é¢˜è®­ç»ƒé¡µé¢

åˆ›å»º `pages/quiz/quiz.vue`ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š

```vue
<template>
  <view class="quiz-page">
    <view v-if="loading" class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <view v-else-if="questions.length > 0" class="quiz-content">
      <!-- å½“å‰é¢˜ç›® -->
      <view class="question-card">
        <view class="question-header">
          <text>é¢˜ç›® {{ currentIndex + 1 }} / {{ questions.length }}</text>
        </view>

        <view class="question-text">
          {{ currentQuestion.question }}
        </view>

        <view class="options">
          <view
            v-for="(option, idx) in currentQuestion.options"
            :key="idx"
            @click="selectOption(option)"
            :class="[
              'option',
              {
                selected: selectedOption === option,
                correct: submitted && option.startsWith(currentQuestion.answer),
                wrong:
                  submitted &&
                  selectedOption === option &&
                  !option.startsWith(currentQuestion.answer),
              },
            ]"
          >
            <text>{{ option }}</text>
          </view>
        </view>

        <view v-if="submitted" class="explanation">
          <text class="label">è§£æï¼š</text>
          <text>{{ currentQuestion.explanation }}</text>
        </view>

        <view class="actions">
          <button
            v-if="!submitted"
            @click="submitAnswer"
            :disabled="!selectedOption"
            type="warn"
          >
            æäº¤ç­”æ¡ˆ
          </button>
          <button v-else @click="nextQuestion" type="primary">
            {{ currentIndex < questions.length - 1 ? "ä¸‹ä¸€é¢˜" : "æŸ¥çœ‹ç»“æœ" }}
          </button>
        </view>
      </view>
    </view>
  </view>
</template>

<script setup>
import { ref, computed, onMounted } from "vue";
import { getRandomQuiz } from "@/utils/request";

const questions = ref([]);
const currentIndex = ref(0);
const selectedOption = ref("");
const submitted = ref(false);
const loading = ref(true);
const score = ref(0);

const currentQuestion = computed(
  () => questions.value[currentIndex.value] || {}
);

onMounted(async () => {
  try {
    const data = await getRandomQuiz();
    questions.value = data;
  } catch (error) {
    uni.showToast({
      title: "åŠ è½½å¤±è´¥",
      icon: "none",
    });
  } finally {
    loading.value = false;
  }
});

const selectOption = (option) => {
  if (!submitted.value) {
    selectedOption.value = option;
  }
};

const submitAnswer = () => {
  submitted.value = true;
  if (selectedOption.value.startsWith(currentQuestion.value.answer)) {
    score.value++;
  }
};

const nextQuestion = () => {
  if (currentIndex.value < questions.value.length - 1) {
    currentIndex.value++;
    selectedOption.value = "";
    submitted.value = false;
  } else {
    showResult();
  }
};

const showResult = () => {
  uni.showModal({
    title: "æµ‹è¯•å®Œæˆ",
    content: `æ‚¨çš„å¾—åˆ†ï¼š${score.value} / ${questions.value.length}`,
    showCancel: false,
  });
};
</script>

<style scoped>
.quiz-page {
  padding: 20rpx;
}

.question-card {
  background-color: white;
  border-radius: 20rpx;
  padding: 40rpx;
  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.05);
}

.question-header {
  text-align: center;
  color: #ff4d4d;
  font-weight: bold;
  margin-bottom: 40rpx;
}

.question-text {
  font-size: 32rpx;
  line-height: 1.6;
  margin-bottom: 40rpx;
  color: #333;
}

.options {
  margin-bottom: 40rpx;
}

.option {
  padding: 30rpx;
  margin-bottom: 20rpx;
  border: 2rpx solid #ddd;
  border-radius: 15rpx;
  background-color: #fff;
  transition: all 0.3s;
}

.option.selected {
  border-color: #ff4d4d;
  background-color: #fff5f5;
}

.option.correct {
  border-color: #4caf50;
  background-color: #e8f5e9;
}

.option.wrong {
  border-color: #f44336;
  background-color: #ffebee;
}

.explanation {
  padding: 30rpx;
  background-color: #fff3e0;
  border-radius: 15rpx;
  margin-bottom: 40rpx;
  line-height: 1.6;
}

.label {
  color: #ff6f00;
  font-weight: bold;
  margin-bottom: 10rpx;
}

.actions button {
  width: 100%;
  margin-bottom: 20rpx;
}
</style>
```

---

## ç¬¬å››æ­¥ï¼šè¿è¡Œå’Œæµ‹è¯•

### 1. å¯åŠ¨åç«¯æœåŠ¡

```powershell
cd server
python app.py
```

### 2. è¿è¡Œå°ç¨‹åº

**ä½¿ç”¨ HBuilderX**ï¼š

```
è¿è¡Œ â†’ è¿è¡Œåˆ°å°ç¨‹åºæ¨¡æ‹Ÿå™¨ â†’ å¾®ä¿¡å¼€å‘è€…å·¥å…·
```

**ä½¿ç”¨å‘½ä»¤è¡Œ**ï¼š

```powershell
npm run dev:mp-weixin
```

### 3. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. å¯¼å…¥é¡¹ç›®ï¼šé€‰æ‹© `dist/dev/mp-weixin` ç›®å½•
3. å¡«å†™ AppIDï¼ˆå¯ä»¥ä½¿ç”¨æµ‹è¯•å·ï¼‰
4. å¼€å§‹è°ƒè¯•

### 4. é…ç½®å¼€å‘ç¯å¢ƒ

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š

```
è¯¦æƒ… â†’ æœ¬åœ°è®¾ç½®
âœ… ä¸æ ¡éªŒåˆæ³•åŸŸå
âœ… ä¸æ ¡éªŒ TLS ç‰ˆæœ¬
```

---

## ç¬¬äº”æ­¥ï¼šå…³é”®å·®å¼‚è¯´æ˜

### 1. å•ä½è½¬æ¢

```css
/* Web */
width: 100px;

/* å°ç¨‹åº */
width: 200rpx; /* 750rpx = å±å¹•å®½åº¦ */
```

### 2. å¯¼èˆªè·³è½¬

```javascript
// Web (Vue Router)
this.$router.push("/chat");

// å°ç¨‹åº (uni-app)
uni.navigateTo({
  url: "/pages/chat/chat",
});

// Tab é¡µé¢ä½¿ç”¨
uni.switchTab({
  url: "/pages/chat/chat",
});
```

### 3. æç¤ºæ¡†

```javascript
// Web
alert("æäº¤æˆåŠŸ");

// å°ç¨‹åº
uni.showToast({
  title: "æäº¤æˆåŠŸ",
  icon: "success",
});

uni.showModal({
  title: "æç¤º",
  content: "ç¡®å®šè¦é€€å‡ºå—ï¼Ÿ",
});
```

### 4. æœ¬åœ°å­˜å‚¨

```javascript
// Web
localStorage.setItem("key", "value");

// å°ç¨‹åº
uni.setStorageSync("key", "value");

// æˆ–å¼‚æ­¥ç‰ˆæœ¬
uni.setStorage({
  key: "key",
  data: "value",
});
```

---

## å¸¸è§é—®é¢˜

### Q1: ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
2. å¾®ä¿¡å¼€å‘è€…å·¥å…·æ˜¯å¦å…³é—­äº†åŸŸåæ ¡éªŒ
3. URL æ˜¯å¦æ­£ç¡®

### Q2: æ ·å¼ä¸ç”Ÿæ•ˆï¼Ÿ

**A**:

1. ç¡®ä¿ä½¿ç”¨ rpx å•ä½
2. æ£€æŸ¥é€‰æ‹©å™¨æ˜¯å¦æ­£ç¡®
3. å°ç¨‹åºä¸æ”¯æŒæŸäº› CSS ç‰¹æ€§

### Q3: ç»„ä»¶æ— æ³•æ˜¾ç¤ºï¼Ÿ

**A**:

1. æ£€æŸ¥ç»„ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ç»„ä»¶å·²æ­£ç¡®æ³¨å†Œ
3. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

## ä¸‹ä¸€æ­¥

1. âœ… å®ŒæˆåŸºç¡€é¡µé¢è¿ç§»
2. â­ï¸ æ·»åŠ  Markdown æ¸²æŸ“ï¼ˆä½¿ç”¨ towxmlï¼‰
3. â­ï¸ ä¼˜åŒ–æ ·å¼å’Œäº¤äº’
4. â­ï¸ æ·»åŠ åˆ†åŒ…åŠ è½½
5. â­ï¸ é…ç½®äº‘å‡½æ•°ï¼ˆå¯é€‰ï¼‰
6. â­ï¸ å‡†å¤‡ä¸Šçº¿å®¡æ ¸

---

## å‚è€ƒæ–‡æ¡£

- [uni-app å®˜æ–¹æ–‡æ¡£](https://uniapp.dcloud.net.cn/)
- [å¾®ä¿¡å°ç¨‹åºæ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [uni-app Vue 3 è¿ç§»æŒ‡å—](https://uniapp.dcloud.net.cn/tutorial/vue3-api.html)

---

**åˆ›å»ºæ—¶é—´**ï¼š2025 å¹´ 10 æœˆ 17 æ—¥  
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š1-2 å‘¨  
**æŠ€æœ¯æ”¯æŒ**ï¼šæœ‰é—®é¢˜éšæ—¶é—®æˆ‘ï¼ ğŸš€
